select  /*+ use_hash(a11 a12 a13 a14 a15 a16 a17 a18 a19 a110 a111 a112 a113 a114 a115 a116 a117 a118 a119 a120 a121 a122 a123 a124 a125 a126 a127 a128 a129 a130 a131 a132 a133 a134 a135 a136 a137 a138 a139 a140) */
  a11.SCENARIO_TYPE_CD           SCENARIO_TYPE_CD,
--  a18.SCENARIO_TYPE_NAME         SCENARIO_TYPE_NAME,
--  a18.SORT_ORDER                 SORT_ORDER,
  DECODE(a13.UP_PROD_CD,'GNT_L3_1','GNTCS','GNT_L3_5','GNTHT')                     DIV_CD,
--  a16.SCRN_DSPL_SEQ              DIV_KOR_NAME,
--  a16.DIV_SHRT_NAME              DIV_SHRT_NAME,
--  a11.SALES_SUBSDR_RNR_CD        SUBSDR_CD,
--  a110.MGT_ORG_SHRT_NAME         MGT_ORG_SHRT_NAME,
--  a110.SORT_ORDER                SORT_ORDER0,
  a11.SUBSDR_CD                  SUBSDR_CD,
  a19.SUBSDR_SHRT_NAME           NEW_SUBSDR_SHRT_NAME,
--  a19.SORT_ORDER                 SORT1_ORDER,
--  a11.PRODUCTION_SUBSDR_CD       SUBSDR_CD1,
--  a17.SUBSDR_SHRT_NAME           SUBSDR_NAME,
--  a17.SORT_ORDER                 SORT_ORDER1,
  a11.ZONE_RNR_CD                ZONE_CD,
  a111.ZONE_NAME                 ZONE_NAME,
  a111.SCRN_DSPL_SEQ             SCRN_DSPL_SEQ,
  a11.CNTRY_RNR_CD               CNTRY_RNR_CD,
  a15.CNTRY_NAME                 CNTRY_NAME,
--  a15.SORT_ORDER                 SORT_ORDER2,
  a11.ACCTG_YYYYMM               BASE_YYYYMM,
  a13.UP_PROD_CD                 PROD_CD,
  a112.PROD_ENG_NAME             PROD_ENG_NAME,
--  a112.SORT_ORDER                SORT_ORDER3,
--  a12.USR_PROD1_LAST_CD          PROD_CD0,
--  a13.PROD_ENG_NAME              PROD_ENG_NAME0,
--  a13.SORT_ORDER                 SORT_ORDER4,
  sum(DECODE(a11.CURRENCY_CD,'USD',a11.NSALES_AMT))        NSALES_USD_AMT,
  sum(DECODE(a11.CURRENCY_CD,'KRW',a11.NSALES_AMT))        NSALES_KRW_AMT,
  sum(DECODE(a11.CURRENCY_CD,'USD',a11.SALES_DEDUCT_AMT))  SALES_DEDUCT_USD_AMT,
  sum(DECODE(a11.CURRENCY_CD,'KRW',a11.SALES_DEDUCT_AMT))  SALES_DEDUCT_KRW_AMT,
  sum(DECODE(a11.CURRENCY_CD,'USD',a11.OTH_SALES_AMT))     OTH_SALES_USD_AMT,
  sum(DECODE(a11.CURRENCY_CD,'KRW',a11.OTH_SALES_AMT))     OTH_SALES_KRW_AMT,
  sum(DECODE(a11.CURRENCY_CD,'USD',a11.MGNL_PRF_AMT))      MGNL_PRF_USD_AMT,
  sum(DECODE(a11.CURRENCY_CD,'KRW',a11.MGNL_PRF_AMT))      MGNL_PRF_KRW_AMT,
  sum(DECODE(a11.CURRENCY_CD,'USD',a11.OI_AMT))            COI_USD_AMT,
  sum(DECODE(a11.CURRENCY_CD,'KRW',a11.OI_AMT))            COI_KRW_AMT
/*
  sum(a11.SALES_QTY)  SALES_QTY,
  sum(a11.NSALES_AMT)  NSALES_AMT,
  sum(a11.SALES_DEDUCT_AMT)  SALES_DEDUCT_AMT,
  sum(a11.OTH_SALES_AMT)  OTH_SALES_AMT,
  sum(a11.MGNL_PRF_AMT)  MGNL_PRF_AMT,
  sum(a11.OI_AMT)  COI_AMT

  sum(a11.SALES_QTY)  SALES_QTY,
  sum(a11.NSALES_AMT)  NSALES_AMT,
  sum(a11.SALES_DEDUCT_AMT)  SALES_DEDUCT_AMT,
  sum(a11.OTH_SALES_AMT)  OTH_SALES_AMT,
  sum(a11.MGNL_PRF_AMT)  MGNL_PRF_AMT,
  sum(a11.OI_AMT)  COI_AMT
  sum(a11.RETAIL_SALES_AMT)  WJXBFS3,
  sum(a11.RETAIL_SALES_TAX_EXCL_AMT)  WJXBFS4,
  sum(a11.DEALER_MARG_AMT)  WJXBFS5,
  sum(a11.SELLIN_BASE_SALES_AMT)  WJXBFS6,
  sum(a11.ADDTNL_DC_AMT)  WJXBFS7,
  sum(a11.GROSS_SALES_AMT)  WJXBFS8,
  sum(a11.SALES_DEDUCT_AMT)  WJXBFS9,
  sum(a11.TRDTM_SELLIN_AMT)  WJXBFSa,
  sum(a11.NTRDTM_SELLIN_AMT)  WJXBFSb,
  sum(a11.NTRDTM_SELLOUT_AMT)  WJXBFSc,
  sum(a11.CASH_DC_AMT)  WJXBFSd,
  sum(a11.CHRGBK_AMT)  WJXBFSe,
  sum(a11.OTH_SALES_DEDUCT_AMT)  WJXBFSf,
  sum(a11.PART_OTH_SALES_AMT)  WJXBFS10,
  sum(a11.PART_SALES_AMT)  WJXBFS11,
  sum(a11.OTH_SALES_AMT)  WJXBFS12,
  (sum(a11.FIX_COGS_AMT) + sum(a11.VAR_COGS_AMT))  WJXBFS13,
  sum(a11.VAR_MTL_COST_AMT)  WJXBFS14,
  sum(a11.VAR_NET_MTL_COST_AMT)  WJXBFS15,
  sum(a11.VAR_INCD_COST_AMT)  WJXBFS16,
  sum(a11.VAR_DEFECT_MTL_COST_AMT)  WJXBFS17,
  (sum(a11.FIX_CONV_COST_AMT) + sum(a11.VAR_CONV_COST_AMT))  WJXBFS18,
  (sum(a11.FIX_LBR_COST_AMT) + sum(a11.VAR_LBR_COST_AMT))  WJXBFS19,
  (sum(a11.FIX_MFG_EXP_AMT) + sum(a11.VAR_MFG_EXP_AMT))  WJXBFS1a,
  (sum(a11.FIX_INLND_COST_AMT) + sum(a11.VAR_INLND_COST_AMT))  WJXBFS1b,
  (sum(a11.FIX_PUR_MD_COGS_AMT) + sum(a11.VAR_PUR_MD_COGS_AMT))  WJXBFS1c,
  (sum(a11.FIX_RYLTY_AMT) + sum(a11.VAR_RYLTY_AMT))  WJXBFS1d,
  (sum(a11.FIX_CUSTOMS_RFND_AMT) + sum(a11.VAR_CUSTOMS_RFND_AMT))  WJXBFS1e,
  (sum(a11.FIX_INV_SCRAP_AMT) + sum(a11.VAR_INV_SCRAP_AMT))  WJXBFS1f,
  (sum(a11.FIX_INV_DVL_AMT) + sum(a11.VAR_INV_DVL_AMT))  WJXBFS20,
  (sum(a11.FIX_COGS_DIFF_ADJ_AMT) + sum(a11.VAR_COGS_DIFF_ADJ_AMT))  WJXBFS21,
  (sum(a11.FIX_RTN_ALLWN_AMT) + sum(a11.VAR_RTN_ALLWN_AMT))  WJXBFS22,
  (sum(a11.FIX_INSTL_EXP_AMT) + sum(a11.VAR_INSTL_EXP_AMT))  WJXBFS23,
  (sum(a11.FIX_RENTAL_COGS_AMT) + sum(a11.VAR_RENTAL_COGS_AMT))  WJXBFS24,
  (sum(a11.FIX_PART_OTH_COGS_AMT) + sum(a11.VAR_PART_OTH_COGS_AMT))  WJXBFS25,
  (sum(a11.FIX_PART_COGS_AMT) + sum(a11.VAR_PART_COGS_AMT))  WJXBFS26,
  (sum(a11.FIX_OTH_COGS_AMT) + sum(a11.VAR_OTH_COGS_AMT))  WJXBFS27,
  (sum(a11.FIX_INTRNL_EXP_AMT) + sum(a11.VAR_INTRNL_EXP_AMT))  WJXBFS28,
  (sum(a11.FIX_INTRNL_EXP_NORM_AMT) + sum(a11.VAR_INTRNL_EXP_NORM_AMT))  WJXBFS29,
  (sum(a11.FIX_INTRNL_EXP_PENL_AMT) + sum(a11.VAR_INTRNL_EXP_PENL_AMT))  WJXBFS2a,
  (sum(a11.FIX_INTRNL_EXP_FUND_AMT) + sum(a11.VAR_INTRNL_EXP_FUND_AMT))  WJXBFS2b,
  (sum(a11.FIX_COGS_OTH_AMT) + sum(a11.VAR_COGS_OTH_AMT))  WJXBFS2c,
  (sum(a11.FIX_PL_GAP_AMT) + sum(a11.VAR_PL_GAP_AMT))  WJXBFS2d,
  (sum(a11.FIX_COGS_GAP_AMT) + sum(a11.VAR_COGS_GAP_AMT))  WJXBFS2e,
  (sum(a11.FIX_SELL_ADM_EXP_AMT) + sum(a11.VAR_SELL_ADM_EXP_AMT))  WJXBFS2f,
  (sum(a11.FIX_SELL_EXP_AMT) + sum(a11.VAR_SELL_EXP_AMT))  WJXBFS30,
  (sum(a11.FIX_SELL_LBR_EXP_AMT) + sum(a11.VAR_SELL_LBR_EXP_AMT))  WJXBFS31,
  (sum(a11.FIX_SELL_TRANSP_EXP_AMT) + sum(a11.VAR_SELL_TRANSP_EXP_AMT))  WJXBFS32,
  (sum(a11.FIX_SELL_COMMS_CHRG_AMT) + sum(a11.VAR_SELL_COMMS_CHRG_AMT))  WJXBFS33,
  (sum(a11.FIX_SELL_ADV_EXP_AMT) + sum(a11.VAR_SELL_ADV_EXP_AMT))  WJXBFS34,
  (sum(a11.FIX_SELL_PR_EXP_AMT) + sum(a11.VAR_SELL_PR_EXP_AMT))  WJXBFS35,
  (sum(a11.FIX_SELL_BDDT_EXP_AMT) + sum(a11.VAR_SELL_BDDT_EXP_AMT))  WJXBFS36,
  (sum(a11.FIX_SELL_EXP_OTH_AMT) + sum(a11.VAR_SELL_EXP_OTH_AMT))  WJXBFS37,
  (sum(a11.FIX_ADM_EXP_AMT) + sum(a11.VAR_ADM_EXP_AMT))  WJXBFS38,
  (sum(a11.FIX_ADM_LBR_EXP_AMT) + sum(a11.VAR_ADM_LBR_EXP_AMT))  WJXBFS39,
  (sum(a11.FIX_ADM_TRANSP_EXP_AMT) + sum(a11.VAR_ADM_TRANSP_EXP_AMT))  WJXBFS3a,
  (sum(a11.FIX_ADM_COMMS_CHRG_AMT) + sum(a11.VAR_ADM_COMMS_CHRG_AMT))  WJXBFS3b,
  (sum(a11.FIX_ADM_EXP_OTH_AMT) + sum(a11.VAR_ADM_EXP_OTH_AMT))  WJXBFS3c,
  (sum(a11.FIX_RND_EXP_AMT) + sum(a11.VAR_RND_EXP_AMT))  WJXBFS3d,
  (sum(a11.FIX_RND_LBR_EXP_AMT) + sum(a11.VAR_RND_LBR_EXP_AMT))  WJXBFS3e,
  (sum(a11.FIX_RND_TRANSP_EXP_AMT) + sum(a11.VAR_RND_TRANSP_EXP_AMT))  WJXBFS3f,
  (sum(a11.FIX_RND_COMMS_CHRG_AMT) + sum(a11.VAR_RND_COMMS_CHRG_AMT))  WJXBFS40,
  (sum(a11.FIX_RND_ORDIN_DEVLM_AMT) + sum(a11.VAR_RND_ORDIN_DEVLM_AMT))  WJXBFS41,
  (sum(a11.FIX_RND_EXP_OTH_AMT) + sum(a11.VAR_RND_EXP_OTH_AMT))  WJXBFS42,
  (sum(a11.FIX_SVC_EXP_AMT) + sum(a11.VAR_SVC_EXP_AMT))  WJXBFS43,
  (sum(a11.FIX_SVC_LBR_EXP_AMT) + sum(a11.VAR_SVC_LBR_EXP_AMT))  WJXBFS44,
  (sum(a11.FIX_SVC_TRANSP_EXP_AMT) + sum(a11.VAR_SVC_TRANSP_EXP_AMT))  WJXBFS45,
  (sum(a11.FIX_SVC_COMMS_CHRG_AMT) + sum(a11.VAR_SVC_COMMS_CHRG_AMT))  WJXBFS46,
  (sum(a11.FIX_SVC_DOM_OVSEA_AMT) + sum(a11.VAR_SVC_DOM_OVSEA_AMT))  WJXBFS47,
  (sum(a11.FIX_SVC_SELL_WTY_RESRV_AMT) + sum(a11.VAR_SVC_SELL_WTY_RESRV_AMT))  WJXBFS48,
  (sum(a11.FIX_SVC_EXP_OTH_AMT) + sum(a11.VAR_SVC_EXP_OTH_AMT))  WJXBFS49,
  sum(a11.MGNL_PRF_AMT)  WJXBFS4a,
  sum(a11.OI_AMT)  WJXBFS4b,
  sum(a11.CONTRB_PRF_AMT)  WJXBFS4c*/
from  NPT_APP.NV_DWW_CON_BEP_SUMM_DW_S  a11
  left outer join  NPT_APP.NV_DWD_SUBSDR_MDL_PERIOD_H  a12
    on   (a11.MDL_SFFX_CD = a12.MDL_SFFX_CD and
  a11.SUBSDR_CD = a12.SUBSDR_CD)
  left outer join  NPT_APP.NV_DWD_RPT_PROD4_M  a13
    on   (a12.USR_PROD1_LAST_CD = a13.PROD_CD)
  left outer join  NPT_APP.NV_DWD_PRFT_CONFM_SCENARIO_H  a14
    on   (a11.ACCTG_YYYYMM = a14.ACCTG_YYYYMM and
  a11.DIV_CD = a14.DIV_CD and
  a11.SCENARIO_TYPE_CD = a14.SCENARIO_TYPE_CD)
  left outer join  NPT_APP.NV_DWD_CNTRY_M  a15
    on   (a11.CNTRY_RNR_CD = a15.CNTRY_CD)
  left outer join  NPT_APP.NV_DWD_DIV_LEAF_M  a16
    on   (a11.DIV_CD = a16.DIV_CD)
  left outer join  NPT_APP.NV_DWD_SUBSDR_M  a17
    on   (a11.PRODUCTION_SUBSDR_CD = a17.SUBSDR_CD)
  left outer join  NPT_APP.NV_DWD_SCENARIO_TYPE_M  a18
    on   (a11.SCENARIO_TYPE_CD = a18.SCENARIO_TYPE_CD)
  left outer join  NPT_APP.NV_DWD_SUBSDR_M  a19
    on   (a11.SUBSDR_CD = a19.SUBSDR_CD)
  left outer join  NPT_APP.NV_DWD_MGT_ORG_RNR_M  a110
    on   (a11.SALES_SUBSDR_RNR_CD = a110.MGT_ORG_CD)
  left outer join  NPT_APP.NV_DWD_ZONE_M  a111
    on   (a11.ZONE_RNR_CD = a111.ZONE_CD)
  left outer join  NPT_APP.NV_DWD_RPT_PROD3_M  a112
    on   (a13.UP_PROD_CD = a112.PROD_CD)
where  (a11.SCENARIO_TYPE_CD in ('AC0')
 and a11.ACCTG_YYYYMM between '201301' and '201601'
 and a11.DIV_CD in ('GNT')
 and a11.CONSLD_SALES_MDL_FLAG in ('Y')
 and a11.CURRM_ACCUM_TYPE_CD in ('CURRM')
 and a11.VRNC_ALC_INCL_EXCL_CD in ('INCL')
 and a11.CURRENCY_CD in ('USD','KRW')
 and a14.CONFIRM_FLAG = 'Y')
group by  
  a11.SCENARIO_TYPE_CD 
 ,DECODE(a13.UP_PROD_CD,'GNT_L3_1','GNTCS','GNT_L3_5','GNTHT')           
 ,a11.SUBSDR_CD        
 ,a19.SUBSDR_SHRT_NAME 
 ,a11.ZONE_RNR_CD      
 ,a111.ZONE_NAME       
 ,a111.SCRN_DSPL_SEQ   
 ,a11.CNTRY_RNR_CD     
 ,a15.CNTRY_NAME       
 ,a11.ACCTG_YYYYMM     
 ,a13.UP_PROD_CD       
 ,a112.PROD_ENG_NAME   
